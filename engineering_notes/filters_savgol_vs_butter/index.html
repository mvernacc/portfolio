
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A portfolio of my engineering work.">
      
      
        <meta name="author" content="Matt Vernacchia">
      
      
        <link rel="canonical" href="https://mvernacc.github.io/portfolio/engineering_notes/filters_savgol_vs_butter/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.13">
    
    
      
        <title>Prefer Butterworth filter over Savitzky-Golay for scientific post-processing - Matt Vernacchia</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/portfolio.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prefer-butterworth-filter-over-savitzky-golay-for-scientific-post-processing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Matt Vernacchia" class="md-header__button md-logo" aria-label="Matt Vernacchia" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Matt Vernacchia
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Prefer Butterworth filter over Savitzky-Golay for scientific post-processing
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mvernacc/portfolio/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    mvernacc/portfolio
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Matt Vernacchia" class="md-nav__button md-logo" aria-label="Matt Vernacchia" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Matt Vernacchia
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mvernacc/portfolio/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    mvernacc/portfolio
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resume
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../publications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Publications
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Engineering Notes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware_projects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hardware Projects
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_projects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Software Projects
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-task-remove-high-frequency-noise-without-distortion" class="md-nav__link">
    <span class="md-ellipsis">
      The task: remove high-frequency noise without distortion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meet-the-contenders" class="md-nav__link">
    <span class="md-ellipsis">
      Meet the contenders
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize-filter-performance-with-bode-plots" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize filter performance with Bode plots
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compare-filters-on-noisy-time-series-data" class="md-nav__link">
    <span class="md-ellipsis">
      Compare filters on noisy time-series data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further reading
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="prefer-butterworth-filter-over-savitzky-golay-for-scientific-post-processing">Prefer Butterworth filter over Savitzky-Golay for scientific post-processing<a class="headerlink" href="#prefer-butterworth-filter-over-savitzky-golay-for-scientific-post-processing" title="Permanent link">&para;</a></h1>
<p><em>2025-05-08</em></p>
<p>For science &amp; engineering data analysis, we often need to smooth noisy time-series measurements.
We want to distort the "real" signal as little as possible (in both amplitude and delay), and we are filtering during post-processing (not real time).</p>
<p>The Savitzky-Golay filter is often touted for providing zero amplitude distortion and zero delay.
However, a Butterworth filter applied forward and backward:</p>
<ul>
<li>also provides zero amplitude distortion and zero delay</li>
<li>better removes high-frequency noise</li>
<li>stands on firmer theoretical ground from a signal-processing perspective</li>
</ul>
<p><strong>tl;dr: Stop using the Savitzky-Golay filter for post-processing and use a forward-backward Butterworth filter instead. My recommended solution is:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">sosfiltfilt</span><span class="p">,</span> <span class="n">butter</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">fs</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># [Hz] TODO sampling frequency</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">fc</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># [Hz] TODO filter cutoff frequency</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">x_raw</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># TODO your signal</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">ORDER</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># 5 probably is fine, note that applying the filter forward-backward</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># effectively doubles the filter order.</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">sos</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="n">ORDER</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fc</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;sos&quot;</span><span class="p">)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">x_filtered</span> <span class="o">=</span> <span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">x_raw</span><span class="p">)</span>
</span></code></pre></div>
<p>The superior characteristics of the forward-backward Butterworth filter are illustrated in the Bode plot below.
If you are new to Bode plots, or simply want more details, read on below.</p>
<p><img src="../../assets/images/engineering_notes/filter_savgol_vs_butter/bode.png" width=100%></p>
<h2 id="the-task-remove-high-frequency-noise-without-distortion">The task: remove high-frequency noise without distortion<a class="headerlink" href="#the-task-remove-high-frequency-noise-without-distortion" title="Permanent link">&para;</a></h2>
<p>Often, we are trying to measure a relatively slow phenomenon, but our sensors also pick up high-frequency noise.<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>
For scientific post-processing, it is imperative to remove the high-frequency noise while:</p>
<ul>
<li>Accurately preserving the <strong>amplitude of the signal</strong>.</li>
<li>Accurately preserving the <strong>signal's position in time</strong>, e.g. because we want to determine the times at which some events in the signal occurred.</li>
</ul>
<p>In signal processing terms, this means we require a filter with:</p>
<ul>
<li>Gain magnitude of 1 in the pass band</li>
<li>Zero phase delay</li>
</ul>
<details>
<summary>Zero delay with non-causal filters</summary>
<p>Zero phase delay is not possible with real-time (causal) filters;
but because we are post-processing, we can cheat and "look ahead in time" (i.e. use a non-causal filter).
This makes our zero delay requirement possible.</p>
</details>
<h2 id="meet-the-contenders">Meet the contenders<a class="headerlink" href="#meet-the-contenders" title="Permanent link">&para;</a></h2>
<p>The <a href="https://en.wikipedia.org/wiki/Butterworth_filter">Butterworth filter</a> has the flattest possible gain in the pass band (for a filter of a given order with monotonically decreasing gain).
That is a strong theoretical recommendation for our scientific post-processing application.</p>
<p>The parameters of the filter are a cutoff frequency and an order:</p>
<ul>
<li>The cutoff frequency should be about 2x the highest frequency you care about in the data, and less than the frequency of known noise sources (e.g. 60 Hz power).</li>
<li>Higher orders make the filter better until numerical instabilities appear. An order of 4 or 5 is good for post-processing with 64-bit floating-point numbers (<a href="https://www.dspguide.com/ch20/4.htm">you may need a lower order for numerical stability with 32-bit floats</a>).</li>
</ul>
<p>The <a href="https://en.wikipedia.org/wiki/Savitzky%E2%80%93Golay_filter">Savitzky–Golay filter</a> can be thought of as fitting a polynomial to successive windows of the data, but in practice it is implemented as a convolution of the signal with a pre-computed kernel (i.e. a FIR filter).
Theoretically, the Savitzky–Golay filter does not have much to recommend it.</p>
<p>Further, the parameters of the filter are specified as a window length and a polynomial order.
It is tricky to relate these to the more useful cutoff frequency; but the window length for a given cutoff frequency can be approximated using <a href="https://doi.org/10.1109/DSP-SPE.2011.5739186">equation 11 from this paper</a>, which I implemented in python as the <a href="https://github.com/mvernacc/filters_savgol_vs_butter/blob/main/helpers.py"><code>savgol_window_length</code></a> function.</p>
<h2 id="visualize-filter-performance-with-bode-plots">Visualize filter performance with Bode plots<a class="headerlink" href="#visualize-filter-performance-with-bode-plots" title="Permanent link">&para;</a></h2>
<p>A <a href="https://en.wikipedia.org/wiki/Bode_plot">Bode plot</a> visualizes the magnitude and phase of a filter's response versus frequency.
For the post-processing application, we want a Bode plot that looks like this:</p>
<figure>
    <img src="../../assets/images/engineering_notes/filter_savgol_vs_butter/ideal_bode_sketch.png" width=70%>
    <figcaption>Ideal Bode plot for scientific post-processing.</figcaption>
</figure>

<p>Now, we can return to the figure this post started with (it is inlined again below): a Bode plot of the Butterworth (blue) and Savitzky–Golay (tan) filters.
For a fair comparison, both filters are set for a -3 dB cutoff at 0.01 times the sampling frequency (vertical black line).</p>
<figure>
    <img src="../../assets/images/engineering_notes/filter_savgol_vs_butter/bode.png" width=100%>
    <figcaption>The Butterworth filter has a much better looking Bode plot than Savitzky–Golay.</figcaption>
</figure>

<p>Both filters have magnitude of 1 in most of the pass band.
At frequencies above the cutoff, the gain of the Butterworth filter drops off rapidly as desired, whereas the behavior of the Savitzky–Golay filter is <em>genuine garbage</em>.</p>
<p>Both filters have zero phase over all frequencies, but that's table stakes for non-causal post-processing.</p>
<h2 id="compare-filters-on-noisy-time-series-data">Compare filters on noisy time-series data<a class="headerlink" href="#compare-filters-on-noisy-time-series-data" title="Permanent link">&para;</a></h2>
<p>The figure below shows each filter's performance on example time series data. The underlying signal is a Lorentzian pulse at <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span>=7 s (black dashed curve), and is contaminated with white noise with a standard deviation of 0.1.</p>
<figure>
    <img src="../../assets/images/engineering_notes/filter_savgol_vs_butter/example_time_domain.png" width=100%>
    <figcaption>The Butterworth forward-backward and Savitzky–Golay both get the time of the peak correct, the Butterworth forward-only filter does not.</figcaption>
</figure>

<p>Both the Butterworth forward-backward (blue) and Savitzky–Golay (tan) filters track the overall shape of the signal well and get the pulse peak at the right time.</p>
<p>As a cautionary note, the plot also shows a forward-only Butterworth filter (red). It has phase delay. If you tried to measure the peak time from this filtered signal, you would get the wrong answer (unless you compensate for the phase delay).
With <code>scipy.signal</code>, <strong>use <code>sosfiltfilt</code>, not <code>sosfilt</code>!</strong></p>
<p>Zooming in, we see that the Butterworth forward-backward filter does a better job of rejecting high-frequency noise than Savitzky–Golay. This is consistent with what we saw in the Bode plot.</p>
<figure>
    <img src="../../assets/images/engineering_notes/filter_savgol_vs_butter/example_time_domain_detail.png" width=100%>
    <figcaption>A time scales shorter than the cutoff, the Butterworth-filtered signal is smooth, whereas Savitzky–Golay leaves high-frequency junk in the filtered signal.</figcaption>
</figure>

<h2 id="code">Code<a class="headerlink" href="#code" title="Permanent link">&para;</a></h2>
<p>The python scripts that made then figures in this post are available <a href="https://github.com/mvernacc/filters_savgol_vs_butter">on github</a>.</p>
<h2 id="further-reading">Further reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.butter.html"><code>scipy.signal.butter</code> docs</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.sosfiltfilt.html"><code>scipy.signal.sosfiltfilt</code> docs</a></li>
<li><a href="https://www.dspguide.com/">S. W. Smith, <em>The Scientist and Engineer's Guide to Digital Signal Processing</em></a></li>
</ul>
<hr />
<p><em>Thank you to James Logan for discussing the ideas in this post with me and reviewing the plots. Any errors are my own.</em></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>This post focuses on removing noise that <em>is separated from the "true" signal in frequency</em> (e.g. electrical noise from 60 Hz power, or high-frequency vibrations of the instrument). Other filtering techniques are better if you want to reject noise on other bases (e.g. outliers).&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Matthew Vernacchia
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/mvernacc" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/matthew-vernacchia-4848023b/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.researchgate.net/profile/Matthew_Vernacchia" target="_blank" rel="noopener" title="www.researchgate.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 32v448h448V32zm262.2 334.4c-6.6 3-33.2 6-50-14.2-9.2-10.6-25.3-33.3-42.2-63.6-8.9 0-14.7 0-21.4-.6v46.4c0 23.5 6 21.2 25.8 23.9v8.1c-6.9-.3-23.1-.8-35.6-.8-13.1 0-26.1.6-33.6.8v-8.1c15.5-2.9 22-1.3 22-23.9V225c0-22.6-6.4-21-22-23.9V193c25.8 1 53.1-.6 70.9-.6 31.7 0 55.9 14.4 55.9 45.6 0 21.1-16.7 42.2-39.2 47.5 13.6 24.2 30 45.6 42.2 58.9 7.2 7.8 17.2 14.7 27.2 14.7zm22.9-135c-23.3 0-32.2-15.7-32.2-32.2V167c0-12.2 8.8-30.4 34-30.4s30.4 17.9 30.4 17.9l-10.7 7.2s-5.5-12.5-19.7-12.5c-7.9 0-19.7 7.3-19.7 19.7v26.8c0 13.4 6.6 23.3 17.9 23.3 14.1 0 21.5-10.9 21.5-26.8h-17.9v-10.7h30.4c0 20.5 4.7 49.9-34 49.9m-116.5 44.7c-9.4 0-13.6-.3-20-.8v-69.7c6.4-.6 15-.6 22.5-.6 23.3 0 37.2 12.2 37.2 34.5 0 21.9-15 36.6-39.7 36.6"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>